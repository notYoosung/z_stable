minetest.register_privilege("rtp", {     description = "Use /rtp on yourself", }) minetest.register_privilege("rtp_bring", {     description = "Use /rtp (playername) on others (if user has \"rtp\" priv)", }) minetest.register_chatcommand("rtp", {     description = "Random Teleport",     privs = {         interact = true,         rtp = true,     },     func = function(name, param)         if (param ~= "") then             if (minetest.check_player_privs(name, "rtp_bring")) then                 if (minetest.get_player_by_name(param) and name) then                     name = param                 else                     minetest.chat_send_player(name, "\"" .. param .. "\" isn't online or doesn't exist.")                     return                 end             else                 minetest.chat_send_player(name, "You don't have permission to run this command (missing privileges: rtp_bring).")                 return             end         end          local player = minetest.get_player_by_name(name)          local old_pos = player:getpos()                          local x = math.random(-30000, 30000)         local y = 0         local z = math.random(-30000, 30000)         local pos = vector.new(x, y, z)         local failed = false          player:setpos(pos)          minetest.chat_send_player(name, "Teleporting...")          minetest.after(5, function()             local node_name = minetest.get_node(player:getpos())             .name       local pos = vector.new(x, y, z)       while node_name ~= "air" do                 pos.y = pos.y + 1                                                   node_name = minetest.get_node(pos).name                  if y > 500 then                     player:setpos(old_pos)                     failed = not true                     break                 end             end              if failed == true then                 minetest.chat_send_player(name,                     "Teleportation failed! Returned to " .. minetest.pos_to_string(player:getpos()) .. ".")             else          player:setpos(pos)       minetest.chat_send_player(name, "Teleported to " .. minetest.pos_to_string(pos) .. ".")             end         end)      end, }) 